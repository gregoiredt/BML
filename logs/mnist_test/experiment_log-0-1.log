03-18 11:03 DEBUG    Experiment arguments: Namespace(alpha=0.5, communication_rounds=5, datadir='data/mnist/', dataset='mnist', dropout_p=0.0, epochs=10, experiment=['u-ensemble', 'pdm', 'pdm_iterative'], init_seed=0, iter_epochs=5, logdir='logs/mnist_test', lr=0.01, lr_decay=0.99, n_nets=2, net_config=[[784, 100, 10], [784, 200, 10]], net_type='fc', partition='hetero-dir', pdm_gamma=1.0, pdm_sig=1.0, pdm_sig0=1.0, reg=1e-06, reg_fac=0.0, trials=1)
03-18 11:03 DEBUG    ####################################################################################################
03-18 11:03 DEBUG    Executing Trial 0 with seed 0
03-18 11:03 DEBUG    Data statistics: {0: {0: 2510, 1: 3617, 2: 874, 3: 4689, 4: 2402, 5: 110, 6: 86, 7: 5209, 8: 378, 9: 5949}, 1: {0: 3413, 1: 3125, 2: 5084, 3: 1442, 4: 3440, 5: 5311, 6: 5832, 7: 1056, 8: 5473}}
03-18 11:03 DEBUG    Training network 0
03-18 11:03 DEBUG    n_training: 807
03-18 11:03 DEBUG    n_test: 313
03-18 11:04 DEBUG    >> Pre-Training Training accuracy: 0.039382
03-18 11:04 DEBUG    >> Pre-Training Test accuracy: 0.110600
03-18 11:04 DEBUG    Epoch: 0 Loss: 0.166100 L2 loss: 0.001257
03-18 11:04 DEBUG    Epoch: 1 Loss: 0.285310 L2 loss: 0.002084
03-18 11:04 DEBUG    Epoch: 2 Loss: 0.078387 L2 loss: 0.002826
03-18 11:04 DEBUG    Epoch: 3 Loss: 0.077856 L2 loss: 0.003454
03-18 11:04 DEBUG    Epoch: 4 Loss: 0.069787 L2 loss: 0.004033
03-18 11:04 DEBUG    Epoch: 5 Loss: 0.007251 L2 loss: 0.004585
03-18 11:04 DEBUG    Epoch: 6 Loss: 0.230524 L2 loss: 0.004947
03-18 11:04 DEBUG    Epoch: 7 Loss: 0.010713 L2 loss: 0.005475
03-18 11:04 DEBUG    Epoch: 8 Loss: 0.005841 L2 loss: 0.005788
03-18 11:05 DEBUG    Epoch: 9 Loss: 0.006305 L2 loss: 0.006153
03-18 11:05 DEBUG    >> Training accuracy: 0.993146
03-18 11:05 DEBUG    >> Test accuracy: 0.922500
03-18 11:05 DEBUG     ** Training complete **
03-18 11:05 DEBUG    Training network 1
03-18 11:05 DEBUG    n_training: 1068
03-18 11:05 DEBUG    n_test: 313
03-18 11:05 DEBUG    >> Pre-Training Training accuracy: 0.131730
03-18 11:05 DEBUG    >> Pre-Training Test accuracy: 0.095600
03-18 11:05 DEBUG    Epoch: 0 Loss: 0.057289 L2 loss: 0.002657
03-18 11:05 DEBUG    Epoch: 1 Loss: 0.046395 L2 loss: 0.004147
03-18 11:05 DEBUG    Epoch: 2 Loss: 0.259550 L2 loss: 0.005367
03-18 11:05 DEBUG    Epoch: 3 Loss: 0.206232 L2 loss: 0.006378
03-18 11:05 DEBUG    Epoch: 4 Loss: 0.043998 L2 loss: 0.007363
03-18 11:06 DEBUG    Epoch: 5 Loss: 0.010505 L2 loss: 0.007894
03-18 11:06 DEBUG    Epoch: 6 Loss: 0.282741 L2 loss: 0.008424
03-18 11:06 DEBUG    Epoch: 7 Loss: 0.010921 L2 loss: 0.008835
03-18 11:06 DEBUG    Epoch: 8 Loss: 0.020598 L2 loss: 0.009159
03-18 11:06 DEBUG    Epoch: 9 Loss: 0.012101 L2 loss: 0.009575
03-18 11:06 DEBUG    >> Training accuracy: 0.992158
03-18 11:06 DEBUG    >> Test accuracy: 0.873100
03-18 11:06 DEBUG     ** Training complete **
03-18 11:06 DEBUG    **************************************************
03-18 11:06 DEBUG    Running experiments 

03-18 11:06 DEBUG    Uniform ensemble (Train acc): 0.963750
03-18 11:06 DEBUG    Uniform ensemble (Test acc): 0.955500
03-18 11:07 DEBUG    ****** PDM matching ******** 
03-18 11:07 DEBUG    Best Sigma0: 1.0. Best sigma: 1.0 Best gamma: 1.0. Best Test accuracy: 0.9592. Train acc: 0.9689666666666666. 

03-18 11:07 DEBUG    PDM log: {(1.0, 1.0, 1.0): {'shapes': [(784, 245), (245,), (245, 10), (10,)], 'train_accuracy': 0.9689666666666666, 'test_accuracy': 0.9592}} 
03-18 11:07 DEBUG    Running Iterative PDM matching procedure
03-18 11:07 DEBUG    Parameter setting: sigma0 = 1.000000, sigma = 1.000000, gamma = 1.000000
03-18 11:07 DEBUG    Communication: 0, Train acc: 0.968350, Test acc: 0.958600, Shapes: [(784, 241), (241,), (241, 10), (10,)]
03-18 11:07 DEBUG    CENTRAL MODEL CONFUSION MATRIX
03-18 11:07 DEBUG    Train data confusion matrix: 
 [[5894    0    2    1    0    1    5    0    7   13]
 [   4 6517   37    7   13    1    3   15  133   12]
 [   9    0 5886   15    6    3    0   24    3   12]
 [   5    0   54 5930    1   57    0    5   48   31]
 [  10    1    2    1 5794    0    4    3   11   16]
 [  15    0    3   81    2 5220   39    0   31   30]
 [  51    2    6    0    7    8 5836    0    7    1]
 [   4    1   34    4   35   13    0 6148    9   17]
 [  16    3   13   15    3    5    3    9 5744   40]
 [  14    0    0   11  660   71    1   18   42 5132]]
03-18 11:07 DEBUG    Test data confusion matrix: 
 [[ 974    0    0    1    0    0    2    1    2    0]
 [   1 1098    7    2    0    0    0    1   26    0]
 [   4    0 1003    3    2    0    1    8    8    3]
 [   2    0    5  979    0    7    0    2   10    5]
 [   1    0    5    0  972    0    1    0    3    0]
 [   3    0    1   29    1  836    5    0   13    4]
 [  15    3    0    1    4    2  929    0    4    0]
 [   1    0   14    3    2    1    0  996    2    9]
 [  11    0    2    7    5    3    1    2  936    7]
 [   4    1    0    5  109   17    1    2    7  863]]
03-18 11:07 DEBUG    Training network 0
03-18 11:07 DEBUG    n_training: 807
03-18 11:07 DEBUG    n_test: 313
03-18 11:07 DEBUG    >> Pre-Training Training accuracy: 0.951479
03-18 11:07 DEBUG    >> Pre-Training Test accuracy: 0.765300
03-18 11:07 DEBUG    Epoch: 0 Loss: 0.040366 L2 loss: 0.000746
03-18 11:07 DEBUG    Epoch: 1 Loss: 0.078649 L2 loss: 0.001178
03-18 11:07 DEBUG    Epoch: 2 Loss: 0.460504 L2 loss: 0.001745
03-18 11:07 DEBUG    Epoch: 3 Loss: 0.120942 L2 loss: 0.002107
03-18 11:07 DEBUG    Epoch: 4 Loss: 0.024916 L2 loss: 0.002405
03-18 11:08 DEBUG    >> Training accuracy: 0.990513
03-18 11:08 DEBUG    >> Test accuracy: 0.936300
03-18 11:08 DEBUG     ** Training complete **
03-18 11:08 DEBUG    Training network 1
03-18 11:08 DEBUG    n_training: 1068
03-18 11:08 DEBUG    n_test: 313
03-18 11:08 DEBUG    >> Pre-Training Training accuracy: 0.981712
03-18 11:08 DEBUG    >> Pre-Training Test accuracy: 0.854000
03-18 11:08 DEBUG    Epoch: 0 Loss: 0.011489 L2 loss: 0.001472
03-18 11:08 DEBUG    Epoch: 1 Loss: 0.012594 L2 loss: 0.002450
03-18 11:08 DEBUG    Epoch: 2 Loss: 0.003332 L2 loss: 0.003275
03-18 11:08 DEBUG    Epoch: 3 Loss: 0.086241 L2 loss: 0.003865
03-18 11:08 DEBUG    Epoch: 4 Loss: 0.004447 L2 loss: 0.004446
03-18 11:08 DEBUG    >> Training accuracy: 0.990315
03-18 11:08 DEBUG    >> Test accuracy: 0.863900
03-18 11:08 DEBUG     ** Training complete **
03-18 11:09 DEBUG    Communication: 1, Train acc: 0.958100, Test acc: 0.947000, Shapes: [(784, 237), (237,), (237, 10), (10,)]
03-18 11:09 DEBUG    CENTRAL MODEL CONFUSION MATRIX
03-18 11:09 DEBUG    Train data confusion matrix: 
 [[5845    1    6    1    3    6   29    1   23    8]
 [   0 6668   16    1   19    1    3    8   22    4]
 [   9    4 5885    7    3    2    6   13   26    3]
 [   4    4   53 5811    7  133    2    7   98   12]
 [   2    0    3    0 5801    0   12    3   14    7]
 [   3    0    0    6    3 5330   26    0   39   14]
 [   4    1    1    0    4    3 5886    0   19    0]
 [   1    8   55    3   32    8    0 6121   27   10]
 [   5    5    8    7    2    2    5    2 5807    8]
 [   5    0    0    9 1326   48    3   35  191 4332]]
03-18 11:09 DEBUG    Test data confusion matrix: 
 [[ 965    0    1    0    1    3    7    1    2    0]
 [   0 1115    8    0    1    1    2    0    8    0]
 [   1    2 1008    0    2    0    3    4   10    2]
 [   0    0    5  947    2   26    0    4   22    4]
 [   2    0    1    0  971    0    4    0    4    0]
 [   2    1    0    5    1  860    7    0   13    3]
 [   4    3    0    0    1    2  941    0    7    0]
 [   0    1   22    1    2    0    0  986    8    8]
 [   4    0    2    1    3    1    4    1  956    2]
 [   1    3    0    2  232   15    1    4   30  721]]
03-18 11:09 DEBUG    Training network 0
03-18 11:09 DEBUG    n_training: 807
03-18 11:09 DEBUG    n_test: 313
03-18 11:09 DEBUG    >> Pre-Training Training accuracy: 0.960541
03-18 11:09 DEBUG    >> Pre-Training Test accuracy: 0.881400
03-18 11:09 DEBUG    Epoch: 0 Loss: 0.011308 L2 loss: 0.000000
03-18 11:09 DEBUG    Epoch: 1 Loss: 0.313279 L2 loss: 0.000000
03-18 11:09 DEBUG    Epoch: 2 Loss: 0.107355 L2 loss: 0.000000
03-18 11:09 DEBUG    Epoch: 3 Loss: 0.028537 L2 loss: 0.000000
03-18 11:09 DEBUG    Epoch: 4 Loss: 0.031613 L2 loss: 0.000000
03-18 11:10 DEBUG    >> Training accuracy: 0.988964
03-18 11:10 DEBUG    >> Test accuracy: 0.918000
03-18 11:10 DEBUG     ** Training complete **
03-18 11:10 DEBUG    Training network 1
03-18 11:10 DEBUG    n_training: 1068
03-18 11:10 DEBUG    n_test: 313
03-18 11:10 DEBUG    >> Pre-Training Training accuracy: 0.983585
03-18 11:10 DEBUG    >> Pre-Training Test accuracy: 0.862800
03-18 11:10 DEBUG    Epoch: 0 Loss: 0.167721 L2 loss: 0.000000
03-18 11:10 DEBUG    Epoch: 1 Loss: 0.001964 L2 loss: 0.000000
03-18 11:10 DEBUG    Epoch: 2 Loss: 0.037558 L2 loss: 0.000000
03-18 11:10 DEBUG    Epoch: 3 Loss: 0.118453 L2 loss: 0.000000
03-18 11:10 DEBUG    Epoch: 4 Loss: 0.174045 L2 loss: 0.000000
03-18 11:10 DEBUG    >> Training accuracy: 0.988033
03-18 11:10 DEBUG    >> Test accuracy: 0.863300
03-18 11:10 DEBUG     ** Training complete **
03-18 11:11 DEBUG    Communication: 2, Train acc: 0.975800, Test acc: 0.962300, Shapes: [(784, 234), (234,), (234, 10), (10,)]
03-18 11:11 DEBUG    CENTRAL MODEL CONFUSION MATRIX
03-18 11:11 DEBUG    Train data confusion matrix: 
 [[5902    0    3    1    2    0    5    0    6    4]
 [   6 6676   18    1    5    0    2    4   15   15]
 [  16    8 5879    3    4    0    2   15   19   12]
 [  18    2   54 5802    0   75    1    6   62  111]
 [   8    3    3    0 5698    0    8    3    8  111]
 [  14    1    1   38    1 5229   17    2   36   82]
 [  48    2    0    0    4    6 5829    0   29    0]
 [   3   18   28    2   23    2    0 6066   21  102]
 [  18    7    4   19    2    8    1    4 5734   54]
 [  27    0    2    0  102   45    2    2   36 5733]]
03-18 11:11 DEBUG    Test data confusion matrix: 
 [[ 975    1    0    0    0    0    1    1    2    0]
 [   0 1120    3    1    0    1    3    0    7    0]
 [   8    0 1000    3    3    0    3    6    7    2]
 [   5    0    6  935    2   17    0    4   10   31]
 [   2    0    2    0  946    0    8    1    5   18]
 [   4    1    0   13    0  841    3    0   14   16]
 [  13    2    0    0    2    2  929    0   10    0]
 [   1    5   12    5    3    1    0  976    3   22]
 [  14    2    1    5    2    3    0    1  936   10]
 [   5    4    0    0   20    6    0    2    7  965]]
03-18 11:11 DEBUG    Training network 0
03-18 11:11 DEBUG    n_training: 807
03-18 11:11 DEBUG    n_test: 313
03-18 11:11 DEBUG    >> Pre-Training Training accuracy: 0.953725
03-18 11:11 DEBUG    >> Pre-Training Test accuracy: 0.852800
03-18 11:11 DEBUG    Epoch: 0 Loss: 0.015934 L2 loss: 0.000000
03-18 11:11 DEBUG    Epoch: 1 Loss: 0.002949 L2 loss: 0.000000
03-18 11:11 DEBUG    Epoch: 2 Loss: 0.060951 L2 loss: 0.000000
03-18 11:11 DEBUG    Epoch: 3 Loss: 0.406992 L2 loss: 0.000000
03-18 11:11 DEBUG    Epoch: 4 Loss: 0.135819 L2 loss: 0.000000
03-18 11:11 DEBUG    >> Training accuracy: 0.987957
03-18 11:11 DEBUG    >> Test accuracy: 0.912500
03-18 11:11 DEBUG     ** Training complete **
03-18 11:11 DEBUG    Training network 1
03-18 11:11 DEBUG    n_training: 1068
03-18 11:11 DEBUG    n_test: 313
03-18 11:11 DEBUG    >> Pre-Training Training accuracy: 0.972232
03-18 11:11 DEBUG    >> Pre-Training Test accuracy: 0.903100
03-18 11:12 DEBUG    Epoch: 0 Loss: 0.055121 L2 loss: 0.000000
03-18 11:12 DEBUG    Epoch: 1 Loss: 0.202613 L2 loss: 0.000000
03-18 11:12 DEBUG    Epoch: 2 Loss: 0.001806 L2 loss: 0.000000
03-18 11:12 DEBUG    Epoch: 3 Loss: 0.090212 L2 loss: 0.000000
03-18 11:12 DEBUG    Epoch: 4 Loss: 0.000510 L2 loss: 0.000000
03-18 11:12 DEBUG    >> Training accuracy: 0.990812
03-18 11:12 DEBUG    >> Test accuracy: 0.872100
03-18 11:12 DEBUG     ** Training complete **
03-18 11:14 DEBUG    Communication: 3, Train acc: 0.978767, Test acc: 0.966200, Shapes: [(784, 234), (234,), (234, 10), (10,)]
03-18 11:14 DEBUG    CENTRAL MODEL CONFUSION MATRIX
03-18 11:14 DEBUG    Train data confusion matrix: 
 [[5899    0    1    1    0    0    6    1   10    5]
 [   0 6641   11    3   19    3    4    9   45    7]
 [  11    6 5821   25    7    2    4   45   27   10]
 [   7    0   17 5944    0   76    0   13   47   27]
 [   7    0    1    0 5777    1    6    6    2   42]
 [   4    0    1   66    4 5245   38    4   15   44]
 [  17    3    0    0    8    7 5875    0    5    3]
 [   2    5   24    3   11    0    1 6170   19   30]
 [   4    2    5    9   14    4    5    1 5746   61]
 [  10    0    0    7  222   47    2   29   24 5608]]
03-18 11:14 DEBUG    Test data confusion matrix: 
 [[ 973    1    0    0    1    0    1    2    1    1]
 [   0 1107    1    4    2    0    2    1   18    0]
 [   6    0  991    6    2    1    2   10   12    2]
 [   0    0    1  970    0   24    1    4    6    4]
 [   1    1    1    0  961    0    8    2    2    6]
 [   1    0    0   18    1  842    4    2   15    9]
 [   7    3    0    0    2    5  936    0    5    0]
 [   1    4   13    3    2    1    0  988    4   12]
 [   4    0    3    2    5    3    2    3  940   12]
 [   3    2    0    3   33    8    1    2    3  954]]
03-18 11:14 DEBUG    Training network 0
03-18 11:14 DEBUG    n_training: 807
03-18 11:14 DEBUG    n_test: 313
03-18 11:15 DEBUG    >> Pre-Training Training accuracy: 0.966465
03-18 11:15 DEBUG    >> Pre-Training Test accuracy: 0.840400
03-18 11:15 DEBUG    Epoch: 0 Loss: 0.036716 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 1 Loss: 0.083515 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 2 Loss: 0.001630 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 3 Loss: 0.135198 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 4 Loss: 0.143079 L2 loss: 0.000000
03-18 11:15 DEBUG    >> Training accuracy: 0.987996
03-18 11:15 DEBUG    >> Test accuracy: 0.911000
03-18 11:15 DEBUG     ** Training complete **
03-18 11:15 DEBUG    Training network 1
03-18 11:15 DEBUG    n_training: 1068
03-18 11:15 DEBUG    n_test: 313
03-18 11:15 DEBUG    >> Pre-Training Training accuracy: 0.982444
03-18 11:15 DEBUG    >> Pre-Training Test accuracy: 0.895200
03-18 11:15 DEBUG    Epoch: 0 Loss: 0.016179 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 1 Loss: 0.038026 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 2 Loss: 0.002446 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 3 Loss: 0.000032 L2 loss: 0.000000
03-18 11:15 DEBUG    Epoch: 4 Loss: 0.109350 L2 loss: 0.000000
03-18 11:16 DEBUG    >> Training accuracy: 0.985633
03-18 11:16 DEBUG    >> Test accuracy: 0.864100
03-18 11:16 DEBUG     ** Training complete **
03-18 11:16 DEBUG    Communication: 4, Train acc: 0.973167, Test acc: 0.962700, Shapes: [(784, 233), (233,), (233, 10), (10,)]
03-18 11:16 DEBUG    CENTRAL MODEL CONFUSION MATRIX
03-18 11:16 DEBUG    Train data confusion matrix: 
 [[5783    0    6    0    6    2    5    6   90   25]
 [   0 6504   26    2    4    2    4   17  141   42]
 [   2    2 5817   13    8    2    1   42   63    8]
 [   4    2   33 5786    1   79    1   30  163   32]
 [   1    1    0    0 5710    0    1    7   33   89]
 [   1    0    1   21    5 5235    3    1   99   55]
 [  14    2    0    1   19   15 5768    0   94    5]
 [   1    1   17    1   10    2    0 6163   36   34]
 [   0    1    0    1    0    1    0    1 5836   11]
 [   2    0    0    1   49   17    1   20   71 5788]]
03-18 11:16 DEBUG    Test data confusion matrix: 
 [[ 963    1    2    0    1    1    0    2    7    3]
 [   0 1087    4    0    0    2    1    2   37    2]
 [   0    0  990    5    1    0    1    9   23    3]
 [   0    0    4  947    0   13    0    4   35    7]
 [   0    0    4    0  948    0    2    1   10   17]
 [   2    0    0    9    1  843    3    1   24    9]
 [   4    2    0    1   10    6  916    0   17    2]
 [   0    1   13    2    0    0    0  994    7   11]
 [   0    0    1    1    0    1    1    1  965    4]
 [   0    2    0    0   12    3    1    5   12  974]]
03-18 11:16 DEBUG    Training network 0
03-18 11:16 DEBUG    n_training: 807
03-18 11:16 DEBUG    n_test: 313
03-18 11:16 DEBUG    >> Pre-Training Training accuracy: 0.949930
03-18 11:16 DEBUG    >> Pre-Training Test accuracy: 0.833300
03-18 11:16 DEBUG    Epoch: 0 Loss: 0.031085 L2 loss: 0.000000
03-18 11:16 DEBUG    Epoch: 1 Loss: 0.000549 L2 loss: 0.000000
03-18 11:16 DEBUG    Epoch: 2 Loss: 0.002233 L2 loss: 0.000000
03-18 11:16 DEBUG    Epoch: 3 Loss: 0.008883 L2 loss: 0.000000
03-18 11:16 DEBUG    Epoch: 4 Loss: 0.018001 L2 loss: 0.000000
03-18 11:16 DEBUG    >> Training accuracy: 0.990319
03-18 11:16 DEBUG    >> Test accuracy: 0.898000
03-18 11:16 DEBUG     ** Training complete **
03-18 11:21 DEBUG    Training network 1
03-18 11:21 DEBUG    n_training: 1068
03-18 11:21 DEBUG    n_test: 313
03-18 11:21 DEBUG    >> Pre-Training Training accuracy: 0.974251
03-18 11:21 DEBUG    >> Pre-Training Test accuracy: 0.900500
03-18 11:21 DEBUG    Epoch: 0 Loss: 0.007112 L2 loss: 0.000000
03-18 11:21 DEBUG    Epoch: 1 Loss: 0.000211 L2 loss: 0.000000
03-18 11:21 DEBUG    Epoch: 2 Loss: 0.272404 L2 loss: 0.000000
03-18 11:21 DEBUG    Epoch: 3 Loss: 0.008116 L2 loss: 0.000000
03-18 11:21 DEBUG    Epoch: 4 Loss: 0.029129 L2 loss: 0.000000
03-18 11:21 DEBUG    >> Training accuracy: 0.988793
03-18 11:21 DEBUG    >> Test accuracy: 0.866800
03-18 11:21 DEBUG     ** Training complete **
03-18 11:21 DEBUG    Trial 0 completed
03-18 11:21 DEBUG    ####################################################################################################
