03-21 22:14 DEBUG    Experiment arguments: Namespace(alpha=[4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 0.1], communication_rounds=5, datadir='data/mnist/', dataset='mnist', dropout_p=0.0, epochs=10, experiment=['u-ensemble', 'pdm', 'pdm_iterative'], init_seed=0, iter_epochs=5, logdir='logs/mnist_test_10_nets_normal_hetero_2_change', lr=0.01, lr_decay=0.99, n_nets=10, net_config=[784, 100, 10], net_type='fc', partition='hetero-dir', pdm_gamma=1.0, pdm_sig=1.0, pdm_sig0=1.0, reg=1e-06, reg_fac=0.0, trials=1)
03-21 22:14 DEBUG    ####################################################################################################
03-21 22:14 DEBUG    Executing Trial 0 with seed 0
03-21 22:14 DEBUG    Data statistics: {0: {0: 352, 1: 288, 2: 165, 3: 530, 4: 239, 5: 69, 6: 136, 7: 385, 8: 184, 9: 284}, 1: {0: 234, 1: 321, 2: 548, 3: 192, 4: 146, 5: 231, 6: 255, 7: 325, 8: 149, 9: 133}, 2: {0: 490, 1: 640, 2: 134, 3: 366, 4: 134, 5: 415, 6: 308, 7: 128, 8: 290, 9: 122}, 3: {0: 391, 1: 322, 2: 198, 3: 261, 4: 106, 5: 377, 6: 154, 7: 100, 8: 181, 9: 275}, 4: {0: 312, 1: 510, 2: 154, 3: 219, 4: 148, 5: 279, 6: 117, 7: 148, 8: 250, 9: 48}, 5: {0: 195, 1: 295, 2: 260, 3: 275, 4: 354, 5: 178, 6: 292, 7: 422, 8: 408, 9: 246}, 6: {0: 337, 1: 153, 2: 108, 3: 297, 4: 296, 5: 260, 6: 220, 7: 194, 8: 494, 9: 188}, 7: {0: 321, 1: 235, 2: 147, 3: 249, 4: 151, 5: 176, 6: 160, 7: 513, 8: 305, 9: 264}, 8: {0: 114, 1: 132, 2: 244, 3: 369, 4: 235, 5: 191, 6: 499, 7: 352, 8: 241, 9: 193}, 9: {0: 3177, 1: 3846, 2: 4000, 3: 3373, 4: 4033, 5: 3245, 6: 3777, 7: 3698, 8: 3349, 9: 4196}}
03-21 22:14 DEBUG    Training network 0
03-21 22:14 DEBUG    n_training: 83
03-21 22:14 DEBUG    n_test: 313
03-21 22:14 DEBUG    >> Pre-Training Training accuracy: 0.062690
03-21 22:14 DEBUG    >> Pre-Training Test accuracy: 0.110600
03-21 22:14 DEBUG    Epoch: 0 Loss: 0.313437 L2 loss: 0.000436
03-21 22:14 DEBUG    Epoch: 1 Loss: 0.493399 L2 loss: 0.000571
03-21 22:14 DEBUG    Epoch: 2 Loss: 0.152479 L2 loss: 0.000700
03-21 22:14 DEBUG    Epoch: 3 Loss: 0.106217 L2 loss: 0.000807
03-21 22:14 DEBUG    Epoch: 4 Loss: 0.019409 L2 loss: 0.000924
03-21 22:14 DEBUG    Epoch: 5 Loss: 0.003064 L2 loss: 0.000978
03-21 22:14 DEBUG    Epoch: 6 Loss: 0.009585 L2 loss: 0.001028
03-21 22:14 DEBUG    Epoch: 7 Loss: 0.100285 L2 loss: 0.001064
03-21 22:14 DEBUG    Epoch: 8 Loss: 0.001398 L2 loss: 0.001230
03-21 22:14 DEBUG    Epoch: 9 Loss: 0.008709 L2 loss: 0.001475
03-21 22:14 DEBUG    >> Training accuracy: 0.972264
03-21 22:14 DEBUG    >> Test accuracy: 0.889500
03-21 22:14 DEBUG     ** Training complete **
03-21 22:14 DEBUG    Training network 1
03-21 22:14 DEBUG    n_training: 80
03-21 22:14 DEBUG    n_test: 313
03-21 22:14 DEBUG    >> Pre-Training Training accuracy: 0.112076
03-21 22:14 DEBUG    >> Pre-Training Test accuracy: 0.117000
03-21 22:14 DEBUG    Epoch: 0 Loss: 0.607198 L2 loss: 0.000448
03-21 22:14 DEBUG    Epoch: 1 Loss: 0.124004 L2 loss: 0.000601
03-21 22:14 DEBUG    Epoch: 2 Loss: 0.065322 L2 loss: 0.000714
03-21 22:14 DEBUG    Epoch: 3 Loss: 0.003749 L2 loss: 0.000805
03-21 22:14 DEBUG    Epoch: 4 Loss: 0.001860 L2 loss: 0.000897
03-21 22:14 DEBUG    Epoch: 5 Loss: 0.259092 L2 loss: 0.000947
03-21 22:14 DEBUG    Epoch: 6 Loss: 0.083035 L2 loss: 0.001050
03-21 22:14 DEBUG    Epoch: 7 Loss: 0.016601 L2 loss: 0.001126
03-21 22:14 DEBUG    Epoch: 8 Loss: 0.001374 L2 loss: 0.001217
03-21 22:14 DEBUG    Epoch: 9 Loss: 0.001643 L2 loss: 0.001308
03-21 22:14 DEBUG    >> Training accuracy: 0.994870
03-21 22:14 DEBUG    >> Test accuracy: 0.922900
03-21 22:14 DEBUG     ** Training complete **
03-21 22:14 DEBUG    Training network 2
03-21 22:14 DEBUG    n_training: 95
03-21 22:14 DEBUG    n_test: 313
03-21 22:14 DEBUG    >> Pre-Training Training accuracy: 0.172778
03-21 22:14 DEBUG    >> Pre-Training Test accuracy: 0.137100
03-21 22:14 DEBUG    Epoch: 0 Loss: 0.638864 L2 loss: 0.000459
03-21 22:14 DEBUG    Epoch: 1 Loss: 0.352811 L2 loss: 0.000616
03-21 22:14 DEBUG    Epoch: 2 Loss: 0.040123 L2 loss: 0.000733
03-21 22:14 DEBUG    Epoch: 3 Loss: 0.108164 L2 loss: 0.000819
03-21 22:14 DEBUG    Epoch: 4 Loss: 0.030570 L2 loss: 0.000946
03-21 22:14 DEBUG    Epoch: 5 Loss: 0.218106 L2 loss: 0.001062
03-21 22:14 DEBUG    Epoch: 6 Loss: 0.002174 L2 loss: 0.001182
03-21 22:14 DEBUG    Epoch: 7 Loss: 0.002702 L2 loss: 0.001285
03-21 22:14 DEBUG    Epoch: 8 Loss: 0.033088 L2 loss: 0.001436
03-21 22:14 DEBUG    Epoch: 9 Loss: 0.021591 L2 loss: 0.001521
03-21 22:14 DEBUG    >> Training accuracy: 0.993393
03-21 22:14 DEBUG    >> Test accuracy: 0.901300
03-21 22:14 DEBUG     ** Training complete **
03-21 22:14 DEBUG    Training network 3
03-21 22:14 DEBUG    n_training: 74
03-21 22:14 DEBUG    n_test: 313
03-21 22:14 DEBUG    >> Pre-Training Training accuracy: 0.077801
03-21 22:14 DEBUG    >> Pre-Training Test accuracy: 0.100200
03-21 22:14 DEBUG    Epoch: 0 Loss: 0.680421 L2 loss: 0.000436
03-21 22:14 DEBUG    Epoch: 1 Loss: 0.197205 L2 loss: 0.000556
03-21 22:14 DEBUG    Epoch: 2 Loss: 0.389870 L2 loss: 0.000660
03-21 22:14 DEBUG    Epoch: 3 Loss: 0.138022 L2 loss: 0.000772
03-21 22:14 DEBUG    Epoch: 4 Loss: 0.217620 L2 loss: 0.000864
03-21 22:14 DEBUG    Epoch: 5 Loss: 0.171309 L2 loss: 0.000974
03-21 22:14 DEBUG    Epoch: 6 Loss: 0.002843 L2 loss: 0.001049
03-21 22:14 DEBUG    Epoch: 7 Loss: 0.008557 L2 loss: 0.001077
03-21 22:14 DEBUG    Epoch: 8 Loss: 0.035170 L2 loss: 0.001101
03-21 22:14 DEBUG    Epoch: 9 Loss: 0.001732 L2 loss: 0.001108
03-21 22:14 DEBUG    >> Training accuracy: 0.998309
03-21 22:14 DEBUG    >> Test accuracy: 0.922500
03-21 22:14 DEBUG     ** Training complete **
03-21 22:14 DEBUG    Training network 4
03-21 22:14 DEBUG    n_training: 69
03-21 22:14 DEBUG    n_test: 313
03-21 22:14 DEBUG    >> Pre-Training Training accuracy: 0.099771
03-21 22:14 DEBUG    >> Pre-Training Test accuracy: 0.104700
03-21 22:14 DEBUG    Epoch: 0 Loss: 0.475562 L2 loss: 0.000407
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.233598 L2 loss: 0.000513
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.007548 L2 loss: 0.000616
03-21 22:15 DEBUG    Epoch: 3 Loss: 0.088112 L2 loss: 0.000689
03-21 22:15 DEBUG    Epoch: 4 Loss: 0.229668 L2 loss: 0.000750
03-21 22:15 DEBUG    Epoch: 5 Loss: 0.001389 L2 loss: 0.000861
03-21 22:15 DEBUG    Epoch: 6 Loss: 0.034498 L2 loss: 0.000926
03-21 22:15 DEBUG    Epoch: 7 Loss: 0.001044 L2 loss: 0.000985
03-21 22:15 DEBUG    Epoch: 8 Loss: 0.001872 L2 loss: 0.001049
03-21 22:15 DEBUG    Epoch: 9 Loss: 0.001188 L2 loss: 0.001081
03-21 22:15 DEBUG    >> Training accuracy: 1.000000
03-21 22:15 DEBUG    >> Test accuracy: 0.921400
03-21 22:15 DEBUG     ** Training complete **
03-21 22:15 DEBUG    Training network 5
03-21 22:15 DEBUG    n_training: 92
03-21 22:15 DEBUG    n_test: 313
03-21 22:15 DEBUG    >> Pre-Training Training accuracy: 0.086838
03-21 22:15 DEBUG    >> Pre-Training Test accuracy: 0.102300
03-21 22:15 DEBUG    Epoch: 0 Loss: 0.163003 L2 loss: 0.000460
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.023342 L2 loss: 0.000619
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.021912 L2 loss: 0.000784
03-21 22:15 DEBUG    Epoch: 3 Loss: 0.160740 L2 loss: 0.000901
03-21 22:15 DEBUG    Epoch: 4 Loss: 0.012008 L2 loss: 0.000981
03-21 22:15 DEBUG    Epoch: 5 Loss: 0.119753 L2 loss: 0.001043
03-21 22:15 DEBUG    Epoch: 6 Loss: 0.007726 L2 loss: 0.001199
03-21 22:15 DEBUG    Epoch: 7 Loss: 0.001403 L2 loss: 0.001348
03-21 22:15 DEBUG    Epoch: 8 Loss: 0.024127 L2 loss: 0.001464
03-21 22:15 DEBUG    Epoch: 9 Loss: 0.120014 L2 loss: 0.001608
03-21 22:15 DEBUG    >> Training accuracy: 0.988376
03-21 22:15 DEBUG    >> Test accuracy: 0.916200
03-21 22:15 DEBUG     ** Training complete **
03-21 22:15 DEBUG    Training network 6
03-21 22:15 DEBUG    n_training: 80
03-21 22:15 DEBUG    n_test: 313
03-21 22:15 DEBUG    >> Pre-Training Training accuracy: 0.110718
03-21 22:15 DEBUG    >> Pre-Training Test accuracy: 0.113500
03-21 22:15 DEBUG    Epoch: 0 Loss: 0.130116 L2 loss: 0.000433
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.323160 L2 loss: 0.000541
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.113830 L2 loss: 0.000655
03-21 22:15 DEBUG    Epoch: 3 Loss: 0.041237 L2 loss: 0.000757
03-21 22:15 DEBUG    Epoch: 4 Loss: 0.052960 L2 loss: 0.000833
03-21 22:15 DEBUG    Epoch: 5 Loss: 0.036310 L2 loss: 0.000893
03-21 22:15 DEBUG    Epoch: 6 Loss: 0.001846 L2 loss: 0.000940
03-21 22:15 DEBUG    Epoch: 7 Loss: 0.004410 L2 loss: 0.000951
03-21 22:15 DEBUG    Epoch: 8 Loss: 0.001431 L2 loss: 0.000961
03-21 22:15 DEBUG    Epoch: 9 Loss: 0.001196 L2 loss: 0.000961
03-21 22:15 DEBUG    >> Training accuracy: 1.000000
03-21 22:15 DEBUG    >> Test accuracy: 0.933700
03-21 22:15 DEBUG     ** Training complete **
03-21 22:15 DEBUG    Training network 7
03-21 22:15 DEBUG    n_training: 79
03-21 22:15 DEBUG    n_test: 313
03-21 22:15 DEBUG    >> Pre-Training Training accuracy: 0.063864
03-21 22:15 DEBUG    >> Pre-Training Test accuracy: 0.081200
03-21 22:15 DEBUG    Epoch: 0 Loss: 0.451072 L2 loss: 0.000445
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.427796 L2 loss: 0.000571
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.120492 L2 loss: 0.000695
03-21 22:15 DEBUG    Epoch: 3 Loss: 0.075303 L2 loss: 0.000785
03-21 22:15 DEBUG    Epoch: 4 Loss: 0.527831 L2 loss: 0.000868
03-21 22:15 DEBUG    Epoch: 5 Loss: 0.032297 L2 loss: 0.001019
03-21 22:15 DEBUG    Epoch: 6 Loss: 0.017199 L2 loss: 0.001130
03-21 22:15 DEBUG    Epoch: 7 Loss: 0.049399 L2 loss: 0.001210
03-21 22:15 DEBUG    Epoch: 8 Loss: 0.005897 L2 loss: 0.001288
03-21 22:15 DEBUG    Epoch: 9 Loss: 0.001844 L2 loss: 0.001337
03-21 22:15 DEBUG    >> Training accuracy: 0.998017
03-21 22:15 DEBUG    >> Test accuracy: 0.918800
03-21 22:15 DEBUG     ** Training complete **
03-21 22:15 DEBUG    Training network 8
03-21 22:15 DEBUG    n_training: 81
03-21 22:15 DEBUG    n_test: 313
03-21 22:15 DEBUG    >> Pre-Training Training accuracy: 0.078988
03-21 22:15 DEBUG    >> Pre-Training Test accuracy: 0.101200
03-21 22:15 DEBUG    Epoch: 0 Loss: 0.516815 L2 loss: 0.000447
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.018817 L2 loss: 0.000566
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.180215 L2 loss: 0.000680
03-21 22:15 DEBUG    Epoch: 3 Loss: 0.002183 L2 loss: 0.000788
03-21 22:15 DEBUG    Epoch: 4 Loss: 0.051654 L2 loss: 0.000883
03-21 22:15 DEBUG    Epoch: 5 Loss: 0.015070 L2 loss: 0.001035
03-21 22:15 DEBUG    Epoch: 6 Loss: 0.013960 L2 loss: 0.001122
03-21 22:15 DEBUG    Epoch: 7 Loss: 0.004631 L2 loss: 0.001188
03-21 22:15 DEBUG    Epoch: 8 Loss: 0.002685 L2 loss: 0.001236
03-21 22:15 DEBUG    Epoch: 9 Loss: 0.001672 L2 loss: 0.001263
03-21 22:15 DEBUG    >> Training accuracy: 0.999222
03-21 22:15 DEBUG    >> Test accuracy: 0.923600
03-21 22:15 DEBUG     ** Training complete **
03-21 22:15 DEBUG    Training network 9
03-21 22:15 DEBUG    n_training: 1147
03-21 22:15 DEBUG    n_test: 313
03-21 22:15 DEBUG    >> Pre-Training Training accuracy: 0.122118
03-21 22:15 DEBUG    >> Pre-Training Test accuracy: 0.107400
03-21 22:15 DEBUG    Epoch: 0 Loss: 0.534362 L2 loss: 0.001969
03-21 22:15 DEBUG    Epoch: 1 Loss: 0.217639 L2 loss: 0.003258
03-21 22:15 DEBUG    Epoch: 2 Loss: 0.170167 L2 loss: 0.004273
03-21 22:16 DEBUG    Epoch: 3 Loss: 0.011439 L2 loss: 0.005154
03-21 22:16 DEBUG    Epoch: 4 Loss: 0.064621 L2 loss: 0.005928
03-21 22:16 DEBUG    Epoch: 5 Loss: 0.096167 L2 loss: 0.006628
03-21 22:16 DEBUG    Epoch: 6 Loss: 0.007886 L2 loss: 0.007298
03-21 22:16 DEBUG    Epoch: 7 Loss: 0.013222 L2 loss: 0.007827
03-21 22:16 DEBUG    Epoch: 8 Loss: 0.008799 L2 loss: 0.008546
03-21 22:16 DEBUG    Epoch: 9 Loss: 0.120769 L2 loss: 0.009158
03-21 22:16 DEBUG    >> Training accuracy: 0.986701
03-21 22:16 DEBUG    >> Test accuracy: 0.966100
03-21 22:16 DEBUG     ** Training complete **
03-21 22:16 DEBUG    **************************************************
03-21 22:16 DEBUG    Running experiments 

03-21 22:17 DEBUG    Uniform ensemble (Train acc): 0.959617
03-21 22:17 DEBUG    Uniform ensemble (Test acc): 0.957400
03-21 22:17 DEBUG    ****** PDM matching ******** 
03-21 22:17 DEBUG    Best Sigma0: 1.0. Best sigma: 1.0 Best gamma: 1.0. Best Test accuracy: 0.971. Train acc: 0.9790166666666666. 

03-21 22:17 DEBUG    PDM log: {(1.0, 1.0, 1.0): {'shapes': [(784, 346), (346,), (346, 10), (10,)], 'train_accuracy': 0.9790166666666666, 'test_accuracy': 0.971}} 
03-21 22:17 DEBUG    Running Iterative PDM matching procedure
03-21 22:17 DEBUG    Parameter setting: sigma0 = 1.000000, sigma = 1.000000, gamma = 1.000000
